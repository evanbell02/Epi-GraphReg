# Epi-GraphReg

This repository contains the code for a final course project for CMSE 410 at Michigan State University. The goal of this project was to reproduce some of the methods of the paper ["Chromatin interactionâ€“aware gene regulatory modeling with graph attention networks."](https://pubmed.ncbi.nlm.nih.gov/35396274/) For the authors' implementation, see [their original repository](https://github.com/karbalayghareh/GraphReg/). This repository has code for training similar models on synthetic datasets. We implement a version of the baseline Epi-CNN model, as well as a version of the Epi-GraphReg model. We also include two synthetic datasets, each with synthetic DNase-seq data, CAGE-seq data, and chromatin interaction graphs for 20 chromosomes. In one dataset, all regulatory elements are enhancers, while in the other there are both enhancers and silencers. For more implementation details about both the models and the datasets see the included technical report `FinalReport.pdf`.

### Environment setup
The conda environment needed to run all scripts in this repository can be created using `conda env create -f environment.yml`. The created environment is called `EGR`, unless another name is specified.

### Preparing data
Synthetic data may be generated by running `scripts/make_data.py`. The data generated by this script is also already available in the `data` folder.

### Training and testing models 
All model training and testing occurs using the PyTorch Lightning command line interface (CLI), and all training settings can easily be configured using `.yml` config files or command line arguments. For example, to train the Epi-GraphReg model, one would run `python scripts/train_epi_graph_reg.py fit -c configs/train_settings.yml`. Testing can also be performed with the Lightning CLI by specifying a checkpoint path.

The default dataset used for training is the dataset that contains enhancers as regulatory elements only. In order to train on the dataset that has both enhancers and silencers, add the flag `--data.data_type='enhancers_and_silencers'` to the training command.

### Pretrained models
Complete checkpoints of pretrained models for both datasets are available in the `pretrained_models` directory.

### Notebooks and figures

The Jupyter notebooks used to generate figures, as well as the output figures, are available in the `notebooks` directory.
